class InitSchema < ActiveRecord::Migration<%= @config.migration_version %>
  def up
    return init_schema if strong_migrations_missing?
    safety_assured { init_schema }
  end

  def down
    raise ActiveRecord::IrreversibleMigration, "The initial migration is not revertable"
  end

  private
    def strong_migrations_missing?
      gem_dependency = Gem::Dependency.new(StrongMigrations)
      gem_dependency.matching_specs.first.present?
    end

    def init_schema
      <%- each_schema_line do |line| -%>
      <%- next if line.strip.empty?  -%>
      <%= "    #{line}" %>
      <%- end -%>
    end
end
